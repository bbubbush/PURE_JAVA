# Stream(스트림)
1. 컬렉터란 무엇인가?
- 요약 : 합치거나 분할하거나 요약하거나(Grouping, Partitioning, Summarize) => GPS
- Collector 인터페이스는 연산을 어떻게 구현할지 제공하는 메서드의 집합.
- Collectors 란 Collector 인터페이스를 바탕으로 미리 정의된 기능을 제공.
- 마블 속 '타넬리어 티번'은 '컬렉터'로서 희귀한 '컬렉션'을 모은다.


Q1. 스트림을 이용해서 컬렉션 타입의 데이터를 질의문처럼 사용할 수 있고 가독성도 훨씬 좋아졌지만, 속도나 가독성면에서 SELECT문이 더 빠르고 나은것 같은데, MYSQL이나 ORACLE같은 DB를 사용하고 있다면 굳이 스트림을 이용해서 데이터를 추출해낼 필요가 있나요?
A. 스크림의 비교대상은 데이터베이스가 될 수 없습니다. 데이터베이스만큼 데이터를 가공, 조회 하는데 빠르고 안전한 어플리케이션은 없으니까요. 그럼 어느시점에, 누구와 스트림을 비교해야할까요?  제 기준으로 대답을 드리자면 스트림은 Java8 이전의 코드들과 비교를 해야 한다고 봅니다. 

상황적인 예를 들어보겠습니다. 영화 API를 제공해주는 C사의 OpenApi를 활용하여 '역대 누적관객수 랭킹'을 조회할 수 있는 ViewCountOfMovies() 메서드가 있습니다. 다만, 이 메서드는 한번에 100만건의 영화정보를 무질서하게 가져옵니다. 우리는 역대 누적관객수 상위 10~20위 사이의 영화정보와, 100만건의 영화정보의 전체 누적관객수를 구하고자 합니다.

이 메서드를 스트림을 활용하기 전이라면 {api조회} - {정렬} - {10~20위 영화정보 추출}의 순서로 진행 할 것입니다. 데이터베이스가 빠르다고 해서 100만건의 데이터를 몽땅 넣어서 SELECT 쿼리를 사용해 원하는 정보를 가져온다면, 결과적으로 더 느린 프로그램이 될 것입니다. 
스트림의 병렬처리는 이런 경우에 빛을 발휘합니다. 우선 정렬은 스트림의 병렬처리나 컬렉션의 직렬처리가 큰 차이가 없을 것 같습니다. 병렬처리 역시 Divide & Conquer 알고리즘을 활용하고, 컬렉션의 List 역시 같은 알고리즘을 활용한 Merge Sort를 사용합니다. 이렇게 보니 어쩌면 직렬처리가 더 빠를꺼 같다는 생각이 듭니다.  하지만 100만건의 전체 누적관객수를 구하는 것은 병렬처리가 압도적으로 빠릅니다. 책의 7장에서도 충분히 나오는 설명이라 이부분은 생략하겠습니다.


Q2.추가적으로 수만건의 데이터를 스트림으로 처리할 경우 심각한 성능저하를 유발한다고 이슈가 되고있습니다. 실제 현업에서도 스트림의 과용에 대한 문제를 제기하고 있는데 스트림 사용의 BEST CASE와 WORST CASE를 조사해주시면 감사하겠습니다.
A. 13기 신입사원과 같이 일하게 되어 사수인 내가 간단한 조회프로그램 업무를 주었다. 3시간이 지난 후, 신입사원은 나에게 와서 대뜸 '조회 프로그램을 만들어 봤는데 에러납니다. 어디가 문제일까요?'          갑자기 상황극을 하면서 어떤 메세지를 전달하고싶은걸까? 이 질문을 받고 처음 든 생각이 위와 비슷했다. 수만건의 데이터를 스트림으로 처리하면 심각한 성능저하가 일어난다? 무조건? 100%?   그러면 지금 이 자리에서 우리가 모여 공부하지도 않았을 것이다. 

책의 7장을 보면 병렬스트림을 제대로 쓰는 방법에 대해 이야기한다. 개인적으로는 스트림의 전체 내용을 관통하는 가장 중요한 부분이라고 생각이 든다. 아무리 쓸줄 알고 문법을 이해하면 뭐하나, 때와 상황에 맞게 쓸 줄 알아야지

다만, 우리같이 경험이 부족한 사람에게는 개인적으로 이렇게 했으면 좋겠다 라는 가이드는 있다. 우선 스트림을 쓴다. 대신 병렬처리를 하지 않는다. 이후에 시간이 된다면 최소 1000건 이상의 데이터를 처리하는 로직부터 병렬처리를 조금씩 해보면서 변화하는 시간을 측정해본다.

병렬처리에 어울리는 자료구조인지, 벙렬처리에 적합한 데이터 처리방법인지 등 다양한 상황을 대입하면서 변경해보면 스스로의 직관이 생길 것이다.

Best case : 일단 스트림으로 코드를 짜본다.
Worst case : 스트림? 뭐 성능저하 심하다며. 굳이 써서 문제 만들지 말자.
- 끝 -
